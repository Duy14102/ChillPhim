import{r as R,j as t,S as Y}from"./index-DS5FZUpn.js";import{g as V,a as X,c as W,b as Z,S as U,N as q,d as J,L as H}from"./LandingMovie-DC_KACF4.js";import K from"./ModalProps-BikT6mAw.js";import{a as G}from"./axios-CCb-kr4I.js";function Q(l){let{swiper:e,extendParams:s,on:d,emit:a,params:o}=l;e.autoplay={running:!1,paused:!1,timeLeft:0},s({autoplay:{enabled:!1,delay:3e3,waitForTransition:!0,disableOnInteraction:!1,stopOnLastSlide:!1,reverseDirection:!1,pauseOnMouseEnter:!1}});let u,f,c=o&&o.autoplay?o.autoplay.delay:3e3,r=o&&o.autoplay?o.autoplay.delay:3e3,n,p=new Date().getTime(),v,N,x,A,E,h,L;function y(i){!e||e.destroyed||!e.wrapperEl||i.target===e.wrapperEl&&(e.wrapperEl.removeEventListener("transitionend",y),!(L||i.detail&&i.detail.bySwiperTouchMove)&&w())}const C=()=>{if(e.destroyed||!e.autoplay.running)return;e.autoplay.paused?v=!0:v&&(r=n,v=!1);const i=e.autoplay.paused?n:p+r-new Date().getTime();e.autoplay.timeLeft=i,a("autoplayTimeLeft",i,i/c),f=requestAnimationFrame(()=>{C()})},F=()=>{let i;return e.virtual&&e.params.virtual.enabled?i=e.slides.filter(g=>g.classList.contains("swiper-slide-active"))[0]:i=e.slides[e.activeIndex],i?parseInt(i.getAttribute("data-swiper-autoplay"),10):void 0},j=i=>{if(e.destroyed||!e.autoplay.running)return;cancelAnimationFrame(f),C();let M=typeof i>"u"?e.params.autoplay.delay:i;c=e.params.autoplay.delay,r=e.params.autoplay.delay;const g=F();!Number.isNaN(g)&&g>0&&typeof i>"u"&&(M=g,c=g,r=g),n=M;const O=e.params.speed,k=()=>{!e||e.destroyed||(e.params.autoplay.reverseDirection?!e.isBeginning||e.params.loop||e.params.rewind?(e.slidePrev(O,!0,!0),a("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(e.slides.length-1,O,!0,!0),a("autoplay")):!e.isEnd||e.params.loop||e.params.rewind?(e.slideNext(O,!0,!0),a("autoplay")):e.params.autoplay.stopOnLastSlide||(e.slideTo(0,O,!0,!0),a("autoplay")),e.params.cssMode&&(p=new Date().getTime(),requestAnimationFrame(()=>{j()})))};return M>0?(clearTimeout(u),u=setTimeout(()=>{k()},M)):requestAnimationFrame(()=>{k()}),M},m=()=>{p=new Date().getTime(),e.autoplay.running=!0,j(),a("autoplayStart")},b=()=>{e.autoplay.running=!1,clearTimeout(u),cancelAnimationFrame(f),a("autoplayStop")},S=(i,M)=>{if(e.destroyed||!e.autoplay.running)return;clearTimeout(u),i||(h=!0);const g=()=>{a("autoplayPause"),e.params.autoplay.waitForTransition?e.wrapperEl.addEventListener("transitionend",y):w()};if(e.autoplay.paused=!0,M){E&&(n=e.params.autoplay.delay),E=!1,g();return}n=(n||e.params.autoplay.delay)-(new Date().getTime()-p),!(e.isEnd&&n<0&&!e.params.loop)&&(n<0&&(n=0),g())},w=()=>{e.isEnd&&n<0&&!e.params.loop||e.destroyed||!e.autoplay.running||(p=new Date().getTime(),h?(h=!1,j(n)):j(),e.autoplay.paused=!1,a("autoplayResume"))},T=()=>{if(e.destroyed||!e.autoplay.running)return;const i=V();i.visibilityState==="hidden"&&(h=!0,S(!0)),i.visibilityState==="visible"&&w()},$=i=>{i.pointerType==="mouse"&&(h=!0,L=!0,!(e.animating||e.autoplay.paused)&&S(!0))},P=i=>{i.pointerType==="mouse"&&(L=!1,e.autoplay.paused&&w())},D=()=>{e.params.autoplay.pauseOnMouseEnter&&(e.el.addEventListener("pointerenter",$),e.el.addEventListener("pointerleave",P))},B=()=>{e.el&&typeof e.el!="string"&&(e.el.removeEventListener("pointerenter",$),e.el.removeEventListener("pointerleave",P))},z=()=>{V().addEventListener("visibilitychange",T)},I=()=>{V().removeEventListener("visibilitychange",T)};d("init",()=>{e.params.autoplay.enabled&&(D(),z(),m())}),d("destroy",()=>{B(),I(),e.autoplay.running&&b()}),d("_freeModeStaticRelease",()=>{(x||h)&&w()}),d("_freeModeNoMomentumRelease",()=>{e.params.autoplay.disableOnInteraction?b():S(!0,!0)}),d("beforeTransitionStart",(i,M,g)=>{e.destroyed||!e.autoplay.running||(g||!e.params.autoplay.disableOnInteraction?S(!0,!0):b())}),d("sliderFirstMove",()=>{if(!(e.destroyed||!e.autoplay.running)){if(e.params.autoplay.disableOnInteraction){b();return}N=!0,x=!1,h=!1,A=setTimeout(()=>{h=!0,x=!0,S(!0)},200)}}),d("touchEnd",()=>{if(!(e.destroyed||!e.autoplay.running||!N)){if(clearTimeout(A),clearTimeout(u),e.params.autoplay.disableOnInteraction){x=!1,N=!1;return}x&&e.params.cssMode&&w(),x=!1,N=!1}}),d("slideChange",()=>{e.destroyed||!e.autoplay.running||(E=!0)}),Object.assign(e.autoplay,{start:m,stop:b,pause:S,resume:w})}function ee(l){const{effect:e,swiper:s,on:d,setTranslate:a,setTransition:o,overwriteParams:u,perspective:f,recreateShadows:c,getEffectParams:r}=l;d("beforeInit",()=>{if(s.params.effect!==e)return;s.classNames.push(`${s.params.containerModifierClass}${e}`),f&&f()&&s.classNames.push(`${s.params.containerModifierClass}3d`);const p=u?u():{};Object.assign(s.params,p),Object.assign(s.originalParams,p)}),d("setTranslate",()=>{s.params.effect===e&&a()}),d("setTransition",(p,v)=>{s.params.effect===e&&o(v)}),d("transitionEnd",()=>{if(s.params.effect===e&&c){if(!r||!r().slideShadows)return;s.slides.forEach(p=>{p.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(v=>v.remove())}),c()}});let n;d("virtualUpdate",()=>{s.params.effect===e&&(s.slides.length||(n=!0),requestAnimationFrame(()=>{n&&s.slides&&s.slides.length&&(a(),n=!1)}))})}function te(l,e){const s=X(e);return s!==e&&(s.style.backfaceVisibility="hidden",s.style["-webkit-backface-visibility"]="hidden"),s}function _(l,e,s){const d=`swiper-slide-shadow${s?`-${s}`:""}${` swiper-slide-shadow-${l}`}`,a=X(e);let o=a.querySelector(`.${d.split(" ").join(".")}`);return o||(o=W("div",d.split(" ")),a.append(o)),o}function ae(l){let{swiper:e,extendParams:s,on:d}=l;s({coverflowEffect:{rotate:50,stretch:0,depth:100,scale:1,modifier:1,slideShadows:!0}}),ee({effect:"coverflow",swiper:e,on:d,setTranslate:()=>{const{width:u,height:f,slides:c,slidesSizesGrid:r}=e,n=e.params.coverflowEffect,p=e.isHorizontal(),v=e.translate,N=p?-v+u/2:-v+f/2,x=p?n.rotate:-n.rotate,A=n.depth,E=Z(e);for(let h=0,L=c.length;h<L;h+=1){const y=c[h],C=r[h],F=y.swiperSlideOffset,j=(N-F-C/2)/C,m=typeof n.modifier=="function"?n.modifier(j):j*n.modifier;let b=p?x*m:0,S=p?0:x*m,w=-A*Math.abs(m),T=n.stretch;typeof T=="string"&&T.indexOf("%")!==-1&&(T=parseFloat(n.stretch)/100*C);let $=p?0:T*m,P=p?T*m:0,D=1-(1-n.scale)*Math.abs(m);Math.abs(P)<.001&&(P=0),Math.abs($)<.001&&($=0),Math.abs(w)<.001&&(w=0),Math.abs(b)<.001&&(b=0),Math.abs(S)<.001&&(S=0),Math.abs(D)<.001&&(D=0);const B=`translate3d(${P}px,${$}px,${w}px)  rotateX(${E(S)}deg) rotateY(${E(b)}deg) scale(${D})`,z=te(n,y);if(z.style.transform=B,y.style.zIndex=-Math.abs(Math.round(m))+1,n.slideShadows){let I=p?y.querySelector(".swiper-slide-shadow-left"):y.querySelector(".swiper-slide-shadow-top"),i=p?y.querySelector(".swiper-slide-shadow-right"):y.querySelector(".swiper-slide-shadow-bottom");I||(I=_("coverflow",y,p?"left":"top")),i||(i=_("coverflow",y,p?"right":"bottom")),I&&(I.style.opacity=m>0?m:0),i&&(i.style.opacity=-m>0?-m:0)}}},setTransition:u=>{e.slides.map(c=>X(c)).forEach(c=>{c.style.transitionDuration=`${u}ms`,c.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(r=>{r.style.transitionDuration=`${u}ms`})})},perspective:()=>!0,overwriteParams:()=>({watchSlidesProgress:!0})})}function se({movie:l}){const[e,s]=R.useReducer((a,o)=>({...a,...o}),{modalState:!1,trailerData:null,viewMoreCate:!1,viewMoreCateIndex:null});function d(a){const o=Math.floor(a/60),u=a%60;return o?`${o}h ${u}p`:`${u}p`}return t.jsxs("div",{className:"heroBanner",children:[l&&l.length>0?t.jsx(U,{effect:"coverflow",grabCursor:!0,autoplay:{delay:3e3,disableOnInteraction:!0,pauseOnMouseEnter:!0},loop:!0,navigation:!0,centeredSlides:!0,slidesPerView:"auto",coverflowEffect:{rotate:0,stretch:0,depth:50,modifier:1,slideShadows:!0},modules:[ae,q,Q],className:"swiperHeroBanner",children:l.map((a,o)=>t.jsxs(J,{children:[t.jsx("div",{className:"imgSwiper",children:t.jsx("img",{loading:"lazy",alt:a.title,src:a.banner.horizontal})}),t.jsxs("div",{className:"in4Swiper",children:[t.jsx("h1",{children:a.movieSeason&&a.movieSeason!==""?`${a.title} (Phần ${a.movieSeason})`:a.title}),t.jsxs("div",{className:"categoryIn4",children:[a.category.slice(0,e.viewMoreCate&&e.viewMoreCateIndex===o?a.category.length:5).map((u,f)=>t.jsx("a",{href:`/List/Genres/${u}/${u}/NF`,className:"mainCategory",children:u},f)),a.category.length>5?t.jsx("span",{onClick:()=>s({viewMoreCate:!e.viewMoreCate,viewMoreCateIndex:e.viewMoreCateIndex?null:o}),className:"plusCategoryIn4",children:e.viewMoreCate&&e.viewMoreCateIndex===o?"Thu gọn":`+ ${a.category.length-5}`}):null]}),t.jsxs("div",{className:"ratingIn4",children:[t.jsxs("div",{className:"ratingChild",children:[t.jsx("div",{className:"brandRate brandImdb",children:"IMDb"}),t.jsxs("div",{style:{letterSpacing:1},className:"rateScore",children:[a.imdbScore,t.jsx("span",{style:{color:"gray"},children:"/10"})]})]}),t.jsxs("div",{className:"ratingChild",children:[t.jsx("div",{className:"brandRate brandAge",children:a.ageRate}),t.jsx("div",{className:"rateScore",children:a.ageRate==="G"?"(Mọi lứa tuổi)":a.ageRate==="PG"?"(Cân nhắc cho trẻ nhỏ)":a.ageRate==="PG-13"?"(13+)":a.ageRate==="R"?"(18+)":"(XXX)"})]}),t.jsxs("div",{className:"ratingChild",children:[t.jsx("div",{className:"brandRate brandTime",children:"⌛"}),t.jsx("div",{className:"rateScore",children:d(a.time)})]})]}),t.jsx("div",{className:"contentIn4",children:a.content}),t.jsxs("div",{className:"buttonIn4",children:[t.jsxs("a",{href:`/Streaming/${a.subtitle}/${a.filmSources[0].title}`,className:"playButton",children:["Xem ngay ",t.jsx("span",{style:{marginLeft:10},children:"▶"})]}),t.jsx("button",{type:"button",onClick:()=>s({modalState:!0,trailerData:a.trailerSource}),className:"trailerButton",children:"Xem trailer"})]})]})]},a._id))}):t.jsx(Y,{containerClassName:"swiperHeroBanner",height:"100%"}),t.jsx(K,{state:e,setState:s,children:t.jsx("iframe",{style:{marginTop:25},allowFullScreen:!0,src:e.trailerData})})]})}function re({Title:l,MarginTop:e,useState:s,useEffect:d,axios:a}){const[o,u]=s(),f=JSON.parse(localStorage.getItem("MovieStorage"));return d(()=>{a({method:"get",url:"http://localhost:3000/api/v1/getMoviesSeen",params:{movies:f}}).then(r=>{u(r.data)})},[]),t.jsxs("div",{style:{marginTop:e},className:"landingMovieChild",children:[t.jsx("div",{className:"landingMovieChildTop",children:t.jsx("p",{className:"landingMovieChildTitle",children:l})}),f&&f.length>0&&o?t.jsx(U,{navigation:!0,breakpoints:{0:{slidesPerView:2},700:{slidesPerView:3},991:{slidesPerView:4},1550:{slidesPerView:5}},spaceBetween:15,modules:[q],className:"swiperLandingMovie",children:f.sort((c,r)=>r.time-c.time).map(c=>{const r=o==null?void 0:o.filter(n=>n.subtitle===c.title)[0];return t.jsxs(J,{children:[t.jsxs("a",{href:`/Streaming/${c.title}/${c.eps}`,children:[t.jsx("div",{style:{height:200},className:"imgSwiper",children:t.jsx("img",{loading:"lazy",alt:c.title,src:r==null?void 0:r.banner.horizontal})}),t.jsx("p",{className:"titleSwiper",children:t.jsx("span",{children:r!=null&&r.movieSeason&&(r==null?void 0:r.movieSeason)!==""?`${r==null?void 0:r.title} (Phần ${r==null?void 0:r.movieSeason})`:r==null?void 0:r.title})}),t.jsx("span",{className:"playButtonSwiper",children:"▶"})]}),t.jsx("div",{className:"filmTotal",children:c.eps})]},c.title)})}):t.jsx(Y,{containerClassName:"swiperLandingMovie"})]})}function de(){const[l,e]=R.useState();return R.useEffect(()=>{G({method:"get",url:"http://localhost:3000/api/v1/getMoviesHomepage"}).then(d=>{e(d.data)})},[]),t.jsxs(t.Fragment,{children:[t.jsx(se,{movie:l==null?void 0:l.heroBanner}),t.jsxs("div",{className:"landingMovie",children:[localStorage.getItem("MovieStorage")?t.jsx(re,{Title:"Phim vừa xem",MarginTop:0,useEffect:R.useEffect,useState:R.useState,axios:G}):null,t.jsx(H,{Title:"Phim mới",MarginTop:localStorage.getItem("MovieStorage")?100:0,movie:l==null?void 0:l.newFilm}),t.jsx(H,{Title:"Phim xem nhiều",MarginTop:100,movie:l==null?void 0:l.mostViewFilm}),t.jsx(H,{Title:"Anime",MarginTop:100,movie:l==null?void 0:l.animeFilm})]})]})}export{de as default};
